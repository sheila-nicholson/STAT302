---
title: "Chapter 2 practice exercises"
author: "Brad McNeney"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

These exercises are adapted from the the Stat2 course text.

First load all the R packages we'll need. Remember to do this for every
R session.

```{r, warning=FALSE}
library(Stat2Data)
library(tidyverse)
```

## True/False questions

Answer true or false, and if false give a reason.

a.  The degrees of freedom for the model is always 1 for simple linear
    regression.

    **True**

b.  The variability due to error (SSE) is always smaller than the
    variation explained by the model (SSM).

    **False, SSE changes with each data set. The worse the model fits,
    the larger the SSE.**

c.  As the estimated error SD increases, the prediction interval for a
    new observation becomes narrower.

    **False, the prediction interval would become wider.**

d.  For the same value of the predictor, the 95% prediction interval for
    a new observation is always wider than the 95% confidence interval
    for the mean response.

    **True**

## 1

Which of the following is a reasonable interpretation of an $r^2$ value
of 0.49.

a.  The explanatory variable explains about 1/4 of the variation in the
    response.
b.  The explanatory variable is significant.
c.  **The explanatory variable explains about half of the variation in
    the response.**
d.  The response variable is significant.

## 2

In the first set of exercises you explored the relationship between
sugar and calories in breakfast cereals. The following R commands show
the scatterplot, and some results from fitting the model.

```{r}
data("Cereal")
ggplot(Cereal,aes(x=Sugar,y=Calories)) +
  geom_point() +  geom_smooth() + 
  geom_smooth(method="lm",se=FALSE, color="red")
ff <- lm(Calories ~ Sugar,data=Cereal)
summary(ff)$coefficients
confint(ff)

# intial look at the plot, there seems to be a positive trend between sugar and 
# calories... which makes sense logically, more sugar == more calories 
# given the resulting p-value - 0.0013 we can say:
# there is 
```

a.  Test the hypothesis that sugar has a linear relationship with
    calories. Report the hypotheses, test statistics, P-value and your
    conclusion.
    -   **null hypothesis: there is no association between sugar and
        calories**

    -   **alternative hypothesis: there is an association between sugar
        and calories**

    -   **test statistic is the t-value = 3.506949, p-value = 0.0013**

    -   **conclusion: there is strong evidence of a positive, linear
        association**
b.  Find and interpret a 95% confidence interval for the slope of this
    regression model.
    -   **we are 95% confident that a 1 g increase in sugar is
        associated with an increase in calories between 1 calorie and 4
        calories**

## 3

This is a continuation of the analysis of data on breakfast cereals. The
following are the diagnostic plots we discussed in Chapter 1.

```{r}
plot(ff,which=1)
plot(ff,which=2)
plot(ff,which=5)
```

a.  Comment on the linear model assumption. Which of the three plots do
    you use for this?

    **Residuals vs Fitted plot. The data appears to be fairly linear,
    there is a slight down tick in the line.**

b.  Comment on the assumption of constant error SD. Which of the three
    plots do you use for this?

    **Residuals vs Fitted plot. The assumption of constant error SD
    seems to be met as the points are randomly scattered around
    residual=0 and appear to be evenly spread.**

c.  Comment on the assumption that the errors are normally distributed.
    Which of the three plots do you use for this?

    **Q-Q plot. There appears to be something going on with the points
    at the very left (all points below line) and very right (all points
    above line) of the plot which could suggest errors with a non-normal
    distribution.**

d.  Do any of the cereals have leverage that stands out from the rest?
    Which of the three plots do you use for this?

    **Residuals vs Leverage plot. The point furthest to right does
    appear to have greater leverage than the other points.**

e.  Do any of the cereals have noteworthy influence, as measured by the
    Cook's distance. Use our rule-of-thumb from the Chapter 1 notes.

    **Residuals vs Leverage plot. No, none of the points have noteworthy
    influence (i.e. Cook's distance \> 1)**

## 4

This is a continuation of the analysis of data on breakfast cereals.
Recall from the Chapter 1 exercises that Mueslix has 13 grams of sugar.

a.  Calculate a 95% **confidence** interval for the mean calories of
    cereals with 13 grams of sugar. Interpret this interval.

    **We are 95% confident that the average calories for Cereals with 13
    g of sugar is between 107.3 and 132.0 calories.**

b.  Calculate a 95% **prediction** interval for the mean calories of
    cereals with 13 grams of sugar. Interpret this interval.

    **We expect about 95% of future cereals with 13 g of sugar to
    contain between 78.6 and 160.7 calories.**

(Hint: See the chapter 2 R demo.)

```{r}
data("Cereal")
ggplot(Cereal, aes(x=Sugar, y=Calories)) +
  geom_point() + geom_smooth() +
  geom_smooth(method="lm", se=FALSE, color="red")
model <- lm(Calories ~ Sugar, data=Cereal)
model
newCereal <- data.frame(Sugar = 13)
predict(model,newdata=newCereal,interval = "confidence",level=0.95)
predict(model,newdata=newCereal,interval = "prediction",level=0.95)
```

## 5

Data on 116 Savannah sparrows includes measurements of weight and wing
length. A scatterplot with smooth and least squares regression line is
shown below.

```{r}
data("Sparrows")
ggplot(Sparrows,aes(x=WingLength,y=Weight)) +
  geom_point() +  geom_smooth() + 
  geom_smooth(method="lm",se=FALSE, color="red")
model2 <- lm(Weight ~ WingLength, data = Sparrows)
summary(model2)$coefficients
confint(model2, parm = "WingLength", level = 0.95)
plot(model2, which = 1)
plot(model2, which = 2)
plot(model2, which = 5)
```

a.  Test the hypothesis that wing length has a linear relationship with
    weight. Report the hypotheses, test statistics, P-value and your
    conclusion.

    -   **null hypothesis: there is no association between wing length
        and weight**

    -   **alternative hypothesis: there is an association between wing
        length and weight**

    -   **test statistic is the t-value = 13.46, p-value = 2.62e-25**

    -   **conclusion: there is very strong evidence of a linear
        association**

b.  Find and interpret a 95% confidence interval for the slope of this
    regression model.

    **We are 95% confident that the slope of the fitted regression line
    is between 0.399 and 0.536.**

c.  Comment on the linear model assumption.

    **Based on the Residuals vs Fitted plot the data appears linear.
    There is a slight bump in the line but nothing major.**

d.  Comment on the assumption of constant error SD.

    **Based on the Residuals vs Fitted plot the points appear to be
    pretty randomly situated and spread across residual = 0.**

e.  Comment on the assumption that the errors are normally distributed.

    **Based on the Q-Q plot the ends of the distribution appear to not
    fit perfectly (points above line on the very left, points below line
    on the very right), this could indicate a non-normal distribution.
    But the seem to fit quite close to the line so it may not be an
    issue.**

f.  Do any of the sparrows have noteworthy influence, as measured by the
    Cook's distance. Use our rule-of-thumb from the Chapter 1 supplement
    notes.

    **No, none of the sparrows have noteworthy influence (Cook's
    distance \> 1)**

## 6

Type `help("SpeciesArea")` into the R console to read about the dataset
on islands in Southeast Asia. The following R code examines the
relationship between the area and number of mammal species on the
islands, both on the log-10 scale.

```{r}
data("SpeciesArea")
SpeciesArea <- mutate(SpeciesArea,
                      log10Area = log10(Area),log10Species=log10(Species))
ggplot(SpeciesArea,aes(x=log10Area,y=log10Species)) + 
  geom_point() +  geom_smooth() + 
  geom_smooth(method="lm",se=FALSE, color="red")
model3 <- lm(log10Species ~ log10Area, data = SpeciesArea)
summary(model3)
confint(model3)
plot(model3, which = 1)
plot(model3, which = 2)
plot(model3, which = 5)
```

a.  Test the hypothesis that log-10-area has a linear relationship with
    log-10-species. Report the hypotheses, test statistics, P-value and
    your conclusion.

    -   **null hypothesis: there is no association between the area of
        an island and the number of species found on the island.**

    -   **alternative hypothesis: there is an association between the
        area of an island and the number of species found on the
        island.**

    -   **test statistic is the t-value = 13.46, p-value = 1.34e-08**

    -   **conclusion: there is very strong evidence of a linear
        association**

b.  Find and interpret a 95% confidence interval for the slope of this
    regression model.

    **We are 95% confident that the slope of the fitted regression line
    is between 0.197 and 0.274.**

c.  Comment on the linear model assumption.

    **Based on the Residuals vs Fitted plot the relationship may not be
    linear, the line seen on the plot has several "bumps" which may
    indicated a larger order polynomial model should be used.**

d.  Comment on the assumption of constant error SD.

    **Based on the Residuals vs Fitted plot there does seem to be a
    region in the middle of the plot that only has points below the
    residual=0 line. At the right part of the graph points are only seem
    above the line.**

e.  Comment on the assumption that the errors are normally distributed.

    **Based on the Q-Q plot the errors do appear to be normally
    distributed as they follow the line quite well.**

f.  Do any of the sparrows have noteworthy influence, as measured by the
    Cook's distance. Use our rule-of-thumb from the Chapter 1 supplement
    notes.

    **No, none of the islands have noteworthy influence (Cook's distance
    \> 1)**
